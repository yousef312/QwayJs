{"version":3,"file":"qway.umd.min.js","sources":["../src/qway.js"],"sourcesContent":["const noop = () => { };\r\nconst keyMap = {\r\n    // Alphanumeric\r\n    \"a\": [\"KeyA\", \"KeyA\", \"a\"],\r\n    \"b\": [\"KeyB\", \"KeyB\", \"b\"],\r\n    \"c\": [\"KeyC\", \"KeyC\", \"c\"],\r\n    \"d\": [\"KeyD\", \"KeyD\", \"d\"],\r\n    \"e\": [\"KeyE\", \"KeyE\", \"e\"],\r\n    \"f\": [\"KeyF\", \"KeyF\", \"f\"],\r\n    \"g\": [\"KeyG\", \"KeyG\", \"g\"],\r\n    \"h\": [\"KeyH\", \"KeyH\", \"h\"],\r\n    \"i\": [\"KeyI\", \"KeyI\", \"i\"],\r\n    \"j\": [\"KeyJ\", \"KeyJ\", \"j\"],\r\n    \"k\": [\"KeyK\", \"KeyK\", \"k\"],\r\n    \"l\": [\"KeyL\", \"KeyL\", \"l\"],\r\n    \"m\": [\"KeyM\", \"KeyM\", \"m\"],\r\n    \"n\": [\"KeyN\", \"KeyN\", \"n\"],\r\n    \"o\": [\"KeyO\", \"KeyO\", \"o\"],\r\n    \"p\": [\"KeyP\", \"KeyP\", \"p\"],\r\n    \"q\": [\"KeyQ\", \"KeyQ\", \"q\"],\r\n    \"r\": [\"KeyR\", \"KeyR\", \"r\"],\r\n    \"s\": [\"KeyS\", \"KeyS\", \"s\"],\r\n    \"t\": [\"KeyT\", \"KeyT\", \"t\"],\r\n    \"u\": [\"KeyU\", \"KeyU\", \"u\"],\r\n    \"v\": [\"KeyV\", \"KeyV\", \"v\"],\r\n    \"w\": [\"KeyW\", \"KeyW\", \"w\"],\r\n    \"x\": [\"KeyX\", \"KeyX\", \"x\"],\r\n    \"y\": [\"KeyY\", \"KeyY\", \"y\"],\r\n    \"z\": [\"KeyZ\", \"KeyZ\", \"z\"],\r\n    \"0\": [\"Digit0\", \"Digit0\", \"0\"],\r\n    \"1\": [\"Digit1\", \"Digit1\", \"1\"],\r\n    \"2\": [\"Digit2\", \"Digit2\", \"2\"],\r\n    \"3\": [\"Digit3\", \"Digit3\", \"3\"],\r\n    \"4\": [\"Digit4\", \"Digit4\", \"4\"],\r\n    \"5\": [\"Digit5\", \"Digit5\", \"5\"],\r\n    \"6\": [\"Digit6\", \"Digit6\", \"6\"],\r\n    \"7\": [\"Digit7\", \"Digit7\", \"7\"],\r\n    \"8\": [\"Digit8\", \"Digit8\", \"8\"],\r\n    \"9\": [\"Digit9\", \"Digit9\", \"9\"],\r\n    // Symbols\r\n    \"-\": [\"Minus\", \"Minus\", \"-\"],\r\n    \"=\": [\"Equal\", \"Equal\", \"=\"],\r\n    \"[\": [\"BracketLeft\", \"BracketLeft\", \"[\"],\r\n    \"]\": [\"BracketRight\", \"BracketRight\", \"]\"],\r\n    \"\\\\\": [\"Backslash\", \"Backslash\", \"\\\\\"],\r\n    \";\": [\"Semicolon\", \"Semicolon\", \";\"],\r\n    \"'\": [\"Quote\", \"Quote\", \"'\"],\r\n    \"`\": [\"Backquote\", \"Backquote\", \"`\"],\r\n    \",\": [\"Comma\", \"Comma\", \",\"],\r\n    \".\": [\"Period\", \"Period\", \".\"],\r\n    \"/\": [\"Slash\", \"Slash\", \"/\"],\r\n    // Whitespace & editing\r\n    \"space\": [\"Space\", \"Space\", \"space\"],\r\n    \"enter\": [\"Enter\", \"Enter\", \"enter\"],\r\n    \"backspace\": [\"Backspace\", \"Backspace\", \"backspace\"],\r\n    \"tab\": [\"Tab\", \"Tab\", \"tab\"],\r\n    \"capslock\": [\"CapsLock\", \"CapsLock\", \"capslock\"],\r\n    \"escape\": [\"Escape\", \"Escape\", \"escape\"],\r\n    \"insert\": [\"Insert\", \"Insert\", \"insert\"],\r\n    \"delete\": [\"Delete\", \"Delete\", \"delete\"],\r\n    \"home\": [\"Home\", \"Home\", \"home\"],\r\n    \"end\": [\"End\", \"End\", \"end\"],\r\n    \"pageup\": [\"PageUp\", \"PageUp\", \"pageup\"],\r\n    \"pagedown\": [\"PageDown\", \"PageDown\", \"pagedown\"],\r\n    \"contextmenu\": [\"ContextMenu\", \"ContextMenu\", \"contextmenu\"],\r\n    // Arrows\r\n    \"arrowup\": [\"ArrowUp\", \"ArrowUp\", \"arrowup\"],\r\n    \"arrowdown\": [\"ArrowDown\", \"ArrowDown\", \"arrowdown\"],\r\n    \"arrowleft\": [\"ArrowLeft\", \"ArrowLeft\", \"arrowleft\"],\r\n    \"arrowright\": [\"ArrowRight\", \"ArrowRight\", \"arrowright\"],\r\n    // Modifiers\r\n    \"shift\": [\"Shift\", [\"ShiftLeft\", \"ShiftRight\"], \"shift\"],\r\n    \"control\": [\"Control\", [\"ControlLeft\", \"ControlRight\", \"MetaLeft\", \"MetaRight\"], \"ctrl\"],\r\n    \"ctrl\": [\"Control\", [\"ControlLeft\", \"ControlRight\", \"MetaLeft\", \"MetaRight\"], \"ctrl\"],\r\n    \"command\": [\"Control\", [\"ControlLeft\", \"ControlRight\", \"MetaLeft\", \"MetaRight\"], \"command\"],\r\n    \"alt\": [\"Alt\", [\"AltLeft\", \"AltRight\"], \"alt\"],\r\n    \"meta\": [\"Meta\", [\"MetaLeft\", \"MetaRight\"], \"meta\"],\r\n    // Function keys\r\n    \"f1\": [\"F1\", \"F1\", \"f1\"],\r\n    \"f2\": [\"F2\", \"F2\", \"f2\"],\r\n    \"f3\": [\"F3\", \"F3\", \"f3\"],\r\n    \"f4\": [\"F4\", \"F4\", \"f4\"],\r\n    \"f5\": [\"F5\", \"F5\", \"f5\"],\r\n    \"f6\": [\"F6\", \"F6\", \"f6\"],\r\n    \"f7\": [\"F7\", \"F7\", \"f7\"],\r\n    \"f8\": [\"F8\", \"F8\", \"f8\"],\r\n    \"f9\": [\"F9\", \"F9\", \"f9\"],\r\n    \"f10\": [\"F10\", \"F10\", \"f10\"],\r\n    \"f11\": [\"F11\", \"F11\", \"f11\"],\r\n    \"f12\": [\"F12\", \"F12\", \"f12\"],\r\n    // Numpad\r\n    \"numlock\": [\"NumLock\", \"NumLock\", \"numlock\"],\r\n    \"numpad0\": [\"Numpad0\", \"Numpad0\", \"numpad0\"],\r\n    \"numpad1\": [\"Numpad1\", \"Numpad1\", \"numpad1\"],\r\n    \"numpad2\": [\"Numpad2\", \"Numpad2\", \"numpad2\"],\r\n    \"numpad3\": [\"Numpad3\", \"Numpad3\", \"numpad3\"],\r\n    \"numpad4\": [\"Numpad4\", \"Numpad4\", \"numpad4\"],\r\n    \"numpad5\": [\"Numpad5\", \"Numpad5\", \"numpad5\"],\r\n    \"numpad6\": [\"Numpad6\", \"Numpad6\", \"numpad6\"],\r\n    \"numpad7\": [\"Numpad7\", \"Numpad7\", \"numpad7\"],\r\n    \"numpad8\": [\"Numpad8\", \"Numpad8\", \"numpad8\"],\r\n    \"numpad9\": [\"Numpad9\", \"Numpad9\", \"numpad9\"],\r\n    \"numpaddecimal\": [\"NumpadDecimal\", \"NumpadDecimal\", \"numpaddecimal\"],\r\n    \"numpaddivide\": [\"NumpadDivide\", \"NumpadDivide\", \"numpaddivide\"],\r\n    \"numpadmultiply\": [\"NumpadMultiply\", \"NumpadMultiply\", \"numpadmultiply\"],\r\n    \"numpadsubtract\": [\"NumpadSubtract\", \"NumpadSubtract\", \"numpadsubtract\"],\r\n    \"numpadadd\": [\"NumpadAdd\", \"NumpadAdd\", \"numpadadd\"],\r\n    \"numpadenter\": [\"NumpadEnter\", \"NumpadEnter\", \"numpadenter\"],\r\n    // Media / browser\r\n    \"printscreen\": [\"PrintScreen\", \"PrintScreen\", \"printscreen\"],\r\n    \"scrolllock\": [\"ScrollLock\", \"ScrollLock\", \"scrolllock\"],\r\n    \"pause\": [\"Pause\", \"Pause\", \"pause\"],\r\n    \"browserback\": [\"BrowserBack\", \"BrowserBack\", \"browserback\"],\r\n    \"browserforward\": [\"BrowserForward\", \"BrowserForward\", \"browserforward\"],\r\n    \"browserrefresh\": [\"BrowserRefresh\", \"BrowserRefresh\", \"browserrefresh\"],\r\n    \"browserstop\": [\"BrowserStop\", \"BrowserStop\", \"browserstop\"],\r\n    \"browsersearch\": [\"BrowserSearch\", \"BrowserSearch\", \"browsersearch\"],\r\n    \"browserfavorites\": [\"BrowserFavorites\", \"BrowserFavorites\", \"browserfavorites\"],\r\n    \"browserhome\": [\"BrowserHome\", \"BrowserHome\", \"browserhome\"],\r\n    \"volumemute\": [\"VolumeMute\", \"VolumeMute\", \"volumemute\"],\r\n    \"volumedown\": [\"VolumeDown\", \"VolumeDown\", \"volumedown\"],\r\n    \"volumeup\": [\"VolumeUp\", \"VolumeUp\", \"volumeup\"],\r\n    \"mediatracknext\": [\"MediaTrackNext\", \"MediaTrackNext\", \"mediatracknext\"],\r\n    \"mediatrackprevious\": [\"MediaTrackPrevious\", \"MediaTrackPrevious\", \"mediatrackprevious\"],\r\n    \"mediaplaypause\": [\"MediaPlayPause\", \"MediaPlayPause\", \"mediaplaypause\"],\r\n    \"launchmail\": [\"LaunchMail\", \"LaunchMail\", \"launchmail\"],\r\n    \"launchapp1\": [\"LaunchApp1\", \"LaunchApp1\", \"launchapp1\"],\r\n    \"launchapp2\": [\"LaunchApp2\", \"LaunchApp2\", \"launchapp2\"],\r\n    \"eject\": [\"Eject\", \"Eject\", \"eject\"],\r\n    // International / misc\r\n    \"intlbackslash\": [\"IntlBackslash\", \"IntlBackslash\", \"intlbackslash\"],\r\n    \"intlro\": [\"IntlRo\", \"IntlRo\", \"intlro\"],\r\n    \"intlyen\": [\"IntlYen\", \"IntlYen\", \"intlyen\"],\r\n    \"intlhash\": [\"IntlHash\", \"IntlHash\", \"intlhash\"],\r\n    \"conversion\": [\"Conversion\", \"Conversion\", \"conversion\"],\r\n    \"nonconversion\": [\"NonConversion\", \"NonConversion\", \"nonconversion\"],\r\n    \"again\": [\"Again\", \"Again\", \"again\"],\r\n    \"copy\": [\"Copy\", \"Copy\", \"copy\"],\r\n    \"cut\": [\"Cut\", \"Cut\", \"cut\"],\r\n    \"paste\": [\"Paste\", \"Paste\", \"paste\"],\r\n    \"find\": [\"Find\", \"Find\", \"find\"],\r\n    \"props\": [\"Props\", \"Props\", \"props\"],\r\n    \"select\": [\"Select\", \"Select\", \"select\"],\r\n    \"undo\": [\"Undo\", \"Undo\", \"undo\"],\r\n    \"redo\": [\"Redo\", \"Redo\", \"redo\"],\r\n    \"help\": [\"Help\", \"Help\", \"help\"],\r\n    \"stop\": [\"Stop\", \"Stop\", \"stop\"],\r\n    \"sleep\": [\"Sleep\", \"Sleep\", \"sleep\"],\r\n    \"wakeup\": [\"WakeUp\", \"WakeUp\", \"wakeup\"],\r\n    \"hiragana\": [\"Hiragana\", \"Hiragana\", \"hiragana\"],\r\n    \"katakana\": [\"Katakana\", \"Katakana\", \"katakana\"],\r\n    \"accept\": [\"Accept\", \"Accept\", \"accept\"],\r\n    \"modechange\": [\"ModeChange\", \"ModeChange\", \"modechange\"]\r\n};\r\n\r\n\r\nconst isMacOS = navigator.userAgentData?.platform === 'macOS' ||\r\n    navigator.platform?.toUpperCase().includes('MAC');\r\nconst isModifier = (key) => [\"ctrl\", \"control\", \"command\", \"shift\", \"alt\", \"meta\"].includes(key);\r\nconst isNavSysKey = (key) => [\"tab\", \"enter\", \"backspace\", \"escape\", \"delete\", \"insert\", \"capslock\", \"printscreen\", \"pause\"].includes(key);\r\nconst isElectron = () => typeof process !== 'undefined' && typeof process.versions === 'object' && !!process.versions.electron;\r\nconst isSensitiveKey = (key) => !isElectron() && [\"f1\", \"f5\", \"f11\", \"f12\"].includes(key);\r\nconst translateKey = (key) => keyMap.hasOwnProperty(key) ? keyMap[key][1] : null;\r\nconst translateCombo = (key) => /^[a-z0-9]$/i.test(key) || [\"arrowleft\", \"arrowright\", \"arrowup\", \"arrowdown\", \"*\"].includes(key) ? (key).toLowerCase() : null;\r\nconst mergeUnique = (arr) => [...new Set(arr)];\r\n\r\n/**\r\n * Utility that help me identify the type of bindings\r\n * @type {Array<{is: (str: string) => boolean, validate: (str: string) => boolean, parse: (str: string) => Array, name: string }>}\r\n */\r\nconst types = [\r\n    {\r\n        // malformed\r\n        test: (str) => str.includes(' ') || (str.includes('+') && str.includes(',')),\r\n        name: \"bad\"\r\n    },\r\n    {\r\n        is: (str) => str.includes('+'),\r\n        validate: (str) => {\r\n            let lst = str.toLowerCase().split('+');\r\n            if (lst.find(a => !keyMap.hasOwnProperty(a))) return \"unknown-keys\";\r\n            if (lst.find(a => isNavSysKey(a))) return \"using-system-keys\";\r\n            let nkf = false;\r\n            lst.forEach((a, i) => {\r\n                if (isModifier(a)) {\r\n                    if (nkf == true) return;\r\n                } else nkf = true;\r\n            })\r\n            if (nkf) return \"modifiers-misplacement\";\r\n            if (lst.find(a => isSensitiveKey(a))) return \"sensitive-keys\";\r\n\r\n            return true;\r\n        },\r\n        parse: (str) => str.split('+'),\r\n        name: \"shortcut\"\r\n    },\r\n    {\r\n        is: (str) => str.includes(','),\r\n        validate: () => true, // no validation here\r\n        parse: (str) => str.split(','),\r\n        name: \"combo\"\r\n    },\r\n    {\r\n        is: (str) => str.includes('=>'),\r\n        validate: (str) => {\r\n            let lst = str.toLowerCase().split('=>');\r\n            return true;\r\n        },\r\n        parse: (str) => str.split('=>'),\r\n        name: \"timed\"\r\n    },\r\n]\r\n\r\nclass BindingEvent extends CustomEvent {\r\n\r\n    constructor(type, payload = {}) {\r\n        if (![\"progress\", \"finish\"].includes(type)) throw new Error(`[QwayJS] Unknown event type \"${type}\"`);\r\n        super(type, {\r\n            detail: payload.detail || null,\r\n            bubbles: payload.bubbles ?? false,\r\n            cancelable: payload.cancelable ?? false,\r\n            composed: payload.composed ?? false\r\n        });\r\n\r\n        this.binding = payload?.binding ?? null;\r\n        this.qway = payload?.qway ?? null;\r\n    }\r\n}\r\n\r\nclass QBuildEvent extends CustomEvent {\r\n    constructor(type, payload = {}) {\r\n        if (![\"change\", \"finish\", \"abort\", \"approved\"].includes(type)) throw new Error(`[QwayJS] Unknown event type \"${type}\"`);\r\n        super(type, {\r\n            detail: payload.detail || null,\r\n            bubbles: payload.bubbles ?? false,\r\n            cancelable: payload.cancelable ?? false,\r\n            composed: payload.composed ?? false\r\n        });\r\n\r\n        this.builder = payload?.builder ?? null;\r\n        this.qway = payload?.qway;\r\n        this.progress = [payload?.current, payload?.len];\r\n\r\n    }\r\n}\r\n\r\n/**\r\n * Single binding/shortcut item with it's own functionalities\r\n */\r\nclass Binding {\r\n\r\n    /**\r\n     * @param {string} content \r\n     * @param {function} callback \r\n     * @param {{ delay: number, fragile: boolean }} options \r\n     */\r\n    constructor(content, callback, options) {\r\n        this.content = content;\r\n        this.callback = callback;\r\n        this.options = options || {};\r\n        this.progress = new Set();\r\n\r\n        this.events = {};\r\n        this.onprogress = noop;\r\n        this.onfinish = noop;\r\n    }\r\n\r\n    /**\r\n     * Trigger certain event action\r\n     * @param {\"keyup\" | \"keydown\"} name \r\n     * @param {KeyboardEvent} ev \r\n     */\r\n    onEvent(name, ev) {\r\n        switch (name) {\r\n            case \"keyup\":\r\n                this.keyUp(ev);\r\n                break;\r\n            case \"keydown\":\r\n                if (this.keyDown(ev)) this.onfinish(this);\r\n                else this.onprogress(this);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset/empty current progress of the binding\r\n     */\r\n    reset() {\r\n\r\n    }\r\n}\r\n\r\n/**\r\n * Shortcut bindings are a sequence of keys, once clicked at the same time with their\r\n * order execute a callback bound to them.\r\n */\r\nclass ShortcutBinding extends Binding {\r\n\r\n    /**\r\n     * List of progresses\r\n     * @type {Array<Set>}\r\n     */\r\n    #progress = [];\r\n\r\n    /**\r\n     * @param {Array<string>} content \r\n     * @param {function} callback \r\n     * @param {*} options \r\n     */\r\n    constructor(content, callback, options) {\r\n        // make sure correct format\r\n        content = mergeUnique(Array.isArray(content) ? content : [content]);\r\n        let seqs = [];\r\n        content.forEach(short => {\r\n            const sequence = short.toLowerCase().split('+').map(translateKey);\r\n            if (sequence.includes(null)) throw new Error(`[QwayJS] Incorrect shortcut format \"${short}\"`);\r\n            seqs.push(sequence);\r\n        })\r\n        // Initiate father class\r\n        super(content, callback, options);\r\n        this.sequences = seqs;\r\n        this.#progress = new Array(seqs.length).fill(new Set());\r\n    }\r\n\r\n    keyUp(e) {\r\n        const code = e.code;\r\n        this.#progress.forEach(prg => {\r\n            prg.delete(code);\r\n        })\r\n    }\r\n\r\n    keyDown(e) {\r\n        const code = e.code,\r\n            _this = this;\r\n        this.#progress.forEach((prg, j) => {\r\n            prg.add(code);\r\n\r\n            const pressed = Array.from(prg);\r\n            const isMatch = _this.sequences[j].every((code, i) => Array.isArray(code) ? code.includes(pressed[i]) : pressed[i] === code);\r\n            if (isMatch) {\r\n                e.preventDefault();\r\n                _this.callback();\r\n                return true;\r\n            }\r\n\r\n        })\r\n    }\r\n\r\n    reset() {\r\n        this.#progress.forEach(prg => prg.clear())\r\n    }\r\n}\r\n\r\n/**\r\n * Combo bindings differ from normal shortcuts in the manner of execution, unlike shortcuts \r\n * `Combo` are about order and timing, you must click the combo string within certain period \r\n * identified by the `delay` between clicks or (sequence construction).\r\n */\r\nclass ComboBinding extends Binding {\r\n\r\n    /**\r\n     * @param {string} content \r\n     * @param {function} callback \r\n     * @param {*} options \r\n     */\r\n    constructor(content, callback, options) {\r\n        options = options || { delay: 300 }\r\n        content = content.toLowerCase();\r\n        // make sure correct format\r\n        const sequence = content.split(' ').map(translateCombo);\r\n        if (sequence.includes(null)) throw new Error(`[QwayJS] Incorrect combo string format \"${content}\"`);\r\n        // Initiate father class\r\n        super(content, callback, options);\r\n        this.sequence = sequence;\r\n        this.timeout = null;\r\n    }\r\n\r\n    keyUp(e) {\r\n        // do nothing in here as combo are about time \r\n    }\r\n\r\n    keyDown(e) {\r\n        let _this = this;\r\n        this.progress.add(e.key.toLowerCase());\r\n        if (this.timeout) clearTimeout(this.timeout);\r\n\r\n        const pressed = Array.from(this.progress);\r\n        const isMatch = this.sequence.every((code, i) => code === \"*\" || (Array.isArray(code) ? code.includes(pressed[i]) : pressed[i] === code));\r\n\r\n        // COMBO are time based shortcuts\r\n        this.timeout = setTimeout(function () {\r\n            _this.progress.clear();\r\n        }, this.options?.delay || 300);\r\n\r\n        if (isMatch) {\r\n            e.preventDefault();\r\n            this.callback();\r\n            return true;\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        if (this.timeout) clearTimeout(this.timeout);\r\n        this.progress.clear();\r\n    }\r\n}\r\n\r\n/**\r\n * Timed keys are a single clicked key that executes it callback after\r\n * a pre-defined period\r\n */\r\nclass TimedKey extends Binding {\r\n\r\n    /**\r\n     * @param {string} content \r\n     * @param {function} callback \r\n     * @param {*} options \r\n     */\r\n    constructor(content, callback, options) {\r\n        content = content.toLowerCase();\r\n        // make sure correct format\r\n        const [rawKey, dur] = content.split('=>');\r\n        let key = translateKey(rawKey);\r\n        if (key === null) throw new Error(`[QwayJS] Incorrect timedkey \"${content}\"`);\r\n        // Initiate father class\r\n        super(content, callback, options);\r\n\r\n        this.key = key;\r\n        this.timeout = null;\r\n        this.dur = parseFloat(dur || \"1000\");\r\n    }\r\n\r\n    keyUp(e) {\r\n        // do nothing in here as combo are about time \r\n        if (this.options?.fragile === true || this.key === e.code.toLowerCase()) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n    }\r\n\r\n    keyDown(e) {\r\n        let _this = this;\r\n\r\n        if (this.key === e.code.toLowerCase() && !this.timeout) {\r\n            e.preventDefault();\r\n\r\n            // COMBO are time based shortcuts\r\n            this.timeout = setTimeout(function () {\r\n                _this.callback();\r\n                _this.timeout = null;\r\n            }, this.dur);\r\n\r\n        } else if (this.options?.fragile === true) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = null;\r\n        }\r\n    }\r\n\r\n    reset() {\r\n        if (this.timeout) clearTimeout(this.timeout);\r\n    }\r\n}\r\n\r\n/**\r\n * Qway interactive shortcut builder interface\r\n */\r\nclass QBuilder {\r\n    #progress = new Set();\r\n\r\n    /**\r\n     * @param {QwayClass} q \r\n     */\r\n    constructor(q) {\r\n        this.q = q;\r\n\r\n        this.on = false;\r\n        this.cb = null;\r\n        this.len = 0;\r\n    }\r\n\r\n    /**\r\n     * Start the interactive creation mode\r\n     * @param {number} len \r\n     * @param {function} cb \r\n     */\r\n    start(len, cb) {\r\n        if (typeof len != \"number\" || len === 0 || typeof cb != 'function')\r\n            throw new Error(`[QwayJS] TypeError: len must be number received \"${typeof len}\", cb must be function recieved \"${typeof cb}\"`)\r\n        this.#progress.clear();\r\n        this.on = true;\r\n        this.cb = cb;\r\n        this.len = len;\r\n    }\r\n\r\n    /**\r\n     * Stop the interactive creation mode\r\n     */\r\n    end() {\r\n        this.#progress.clear();\r\n        this.on = false;\r\n    }\r\n\r\n    /**\r\n     * Receive a keyclick from the user\r\n     * @param {string} evName \r\n     * @param {KeyboardEvent} ev \r\n     */\r\n    receive(evName, ev) {\r\n        if (evName == \"keydown\" && this.#progress.size >= this.len) return;\r\n\r\n        switch (evName) {\r\n            case \"keydown\":\r\n                this.#progress.add(ev.code);\r\n                break;\r\n            case \"keyup\":\r\n                this.#progress.delete(ev.code);\r\n                break;\r\n        }\r\n\r\n        this.q.trigger('builder-change', this, new QBuildEvent('change', { builder: this, current: this.#progress.size, len: this.len, qway: this.q }));\r\n        if (this.#progress.size == this.len)\r\n            this.q.trigger('builder-finish', this, new QBuildEvent('finish', { builder: this, current: this.#progress.size, len: this.len, qway: this.q }));\r\n    }\r\n\r\n    /**\r\n     * Approve the current shortcut\r\n     */\r\n    approve() {\r\n        this.q.bind(this.getString('+'), this.cb);\r\n        this.q.trigger('builder-approved', this, new QBuildEvent('approved', { builder: this, qway: this.q }));\r\n        this.end();\r\n    }\r\n\r\n    /**\r\n     * Abort the current shortcut\r\n     */\r\n    abort() {\r\n        if (this.on) {\r\n            this.q.trigger('builder-abort', this, new QBuildEvent('abort', { builder: this, qway: this.q }));\r\n            this.end();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get shortcut string representation\r\n     * @param {string?} joinment optionally separate the shortcut\r\n     * @returns {string|Array}\r\n     */\r\n    getString(joinment) {\r\n        let final = [];\r\n        let fs = Object.values(keyMap);\r\n        Array.from(this.#progress).forEach(kcode => {\r\n            final.push(fs.find(a => Array.isArray(a[1]) ? a[1].includes(kcode) : a[1] === kcode)[2]);\r\n        })\r\n        return typeof joinment == \"string\" ? final.join(joinment) : final;\r\n    }\r\n}\r\n\r\n/**\r\n * Shortcuts are essential time savers to speed-up your app workflow!\r\n * \r\n * Our little library offers a plenty of shortcut types facilitating your access \r\n * to them with a crunchy ;) interface.\r\n * \r\n */\r\nclass QwayClass {\r\n    /**\r\n     * List of bindings\r\n     * @type {Array<Binding>}\r\n     */\r\n    #bindings = [];\r\n\r\n    /**\r\n     * Key actions map \r\n     * @type {Array<{ key: string, code: string, on: boolean}>}\r\n     */\r\n    #keys = {};\r\n\r\n    #events = {};\r\n    #activated = true;\r\n\r\n    constructor() {\r\n\r\n        this.builder = new QBuilder(this);\r\n\r\n        this.#bindEvents();\r\n    }\r\n\r\n    #bindEvents() {\r\n        let _this = this;\r\n        window.addEventListener('keydown', function (e) {\r\n            if (_this.builder.on)\r\n                _this.builder.receive('keydown', e);\r\n            if (!_this.#activated) return;\r\n            _this.#bindings.forEach(bnd => {\r\n                bnd.onEvent(\"keydown\", e);\r\n            })\r\n            _this.#keys[e.code] = true;\r\n        })\r\n\r\n        window.addEventListener('keyup', function (e) {\r\n            if (_this.builder.on)\r\n                _this.builder.receive('keyup', e);\r\n            if (!_this.#activated) return;\r\n            _this.#bindings.forEach(bnd => {\r\n                bnd.onEvent(\"keyup\", e);\r\n            })\r\n            _this.#keys[e.code] = false;\r\n        })\r\n\r\n        window.addEventListener('blur', function () {\r\n            _this.#bindings.forEach(bnd => {\r\n                bnd.reset();\r\n            })\r\n            _this.declineFromUser();\r\n        })\r\n    }\r\n\r\n    /**\r\n    * Bind new shortcut \r\n    * @param {string} shortcut \r\n    * @param {function} callback \r\n    */\r\n    bind(shortcut, callback) {\r\n        let _this = this;\r\n\r\n        if (this.reserved(shortcut)) return false;\r\n\r\n        let bnd;\r\n        if (shortcut.includes('+') || (Array.isArray(shortcut)))\r\n            bnd = new ShortcutBinding(shortcut, callback);\r\n        else if (shortcut.includes(' '))\r\n            bnd = new ComboBinding(shortcut, callback);\r\n        else if (shortcut.includes('=>'))\r\n            bnd = new TimedKey(shortcut, callback);\r\n\r\n        if (!bnd) throw new Error(`[QwayJS] Could bind the new shortcut!`);\r\n\r\n        bnd.onprogress = function (e) {\r\n            _this.trigger('progress', e, new BindingEvent('progress', { binding: e, qway: _this }));\r\n        }\r\n\r\n        bnd.onfinish = function (e) {\r\n            _this.trigger('finish', e, new BindingEvent('finish', { binding: e, qway: _this }));\r\n        }\r\n        this.#bindings.push(bnd);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Remove a shortcut\r\n     * @param {string} shortcut \r\n     * @param {function} callback \r\n     * @returns {boolean}\r\n     */\r\n    unbind(shortcut, callback) {\r\n        let i = this.#bindings.findIndex(a => a.content == shortcut && a.callback === callback);\r\n        if (i != -1) {\r\n            this.#bindings.splice(i, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Replace the callback's shortcut\r\n     * @param {function} callback \r\n     * @param {string} shortcut \r\n     */\r\n    replace(callback, shortcut) {\r\n        let bnd = this.#bindings.find(a => a.callback === callback);\r\n        if (bnd) {\r\n            this.unbind(bnd.content, bnd.callback);\r\n            this.bind(shortcut, callback);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Attach an event listener\r\n     * @param {\"progress\" | \"finish\" | \"builder-change\" | \"builder-abort\" | \"builder-approved\"} ev \r\n     * @param {function} cb\r\n     * @returns {QwayClass} \r\n     */\r\n    on(ev, cb) {\r\n        if (typeof cb !== \"function\") throw new Error(`[QwayJS] .on accepts a function as callback a \"${typeof cb}\" is passed!`);\r\n        if (!this.#events[ev]) this.#events[ev] = [];\r\n        this.#events[ev].push(cb);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Remove an attached event listener\r\n     * @param {\"progress\" | \"finish\"} ev \r\n     * @param {function} cb \r\n     * @returns {boolean} \r\n     */\r\n    off(ev, cb) {\r\n        if (typeof cb !== \"function\") throw new Error(`[QwayJS] .on accepts a function as callback a \"${typeof cb}\" is passed!`);\r\n        if (!this.#events[ev]) return;\r\n\r\n        let i = this.#events[ev].findIndex(a => a === cb);\r\n        if (i != -1) {\r\n            this.#events.splice(i, 1);\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Trigger an event\r\n     * @param {\"progress\" | \"finish\"} ev \r\n     * @param {*} ctx \r\n     * @param  {...any} args \r\n     */\r\n    trigger(ev, ctx, ...args) {\r\n        if (this.#events[ev])\r\n            this.#events[ev].forEach(cb => cb.call(ctx, ...args));\r\n    }\r\n\r\n    /**\r\n     * Check whether a key is currently pressed or not\r\n     * @param {string} key \r\n     * @returns {boolean}\r\n     */\r\n    isKeyPressed(key) {\r\n        key = key === \" \" ? \"space\" : key.toLowerCase();\r\n        if (keyMap[key]) {\r\n            return this.#keys[keyMap[key][1]] || false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Interactively creates a new shortcut entered by the user, the callback already\r\n     * do have a shortcut, it will be replaced by the new one unless you \r\n     * @param {number} len the length of the shortcut \r\n     * @param {function} cb the callback to be attached\r\n     */\r\n    getFromUser(len, cb) {\r\n        this.#activated = false;\r\n        this.builder.start(len, cb);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Approve user created shortcut from interactive mode\r\n     * @param {boolean} replaceInCase\r\n     */\r\n    approveFromUser(replaceInCase) {\r\n        if (replaceInCase === true) {\r\n            let fn = this.attached(this.builder.cb)\r\n            if (fn) {\r\n                this.unbind(this.#bindings[fn].content, this.#bindings[fn].callback);\r\n            }\r\n        }\r\n        this.builder.approve();\r\n        this.#activated = true;\r\n    }\r\n\r\n    /**\r\n     * Decline user created shortcut from interactive mode\r\n     */\r\n    declineFromUser() {\r\n        this.builder.abort();\r\n        this.#activated = true;\r\n    }\r\n\r\n    /**\r\n     * Activate the Qwaay shortcuts\r\n     */\r\n    activate() {\r\n        this.#activated = true;\r\n    }\r\n\r\n    /**\r\n     * Disactivate the Qwaay shortcuts\r\n     */\r\n    disactivate() {\r\n        this.#activated = false;\r\n        this.#bindings.forEach(bnd => bnd.reset());\r\n    }\r\n\r\n    /**\r\n     * Check whether a shortcut is reserved or not\r\n     * @param {string} shortcut \r\n     * @returns {boolean}\r\n     */\r\n    reserved(shortcut) {\r\n        return this.#bindings.findIndex(a => a.content === shortcut) != -1;\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not this function is attached to a shortcut or not\r\n     * @param {function} callback \r\n     * @returns {boolean}\r\n     */\r\n    attached(callback) {\r\n        return this.#bindings.findIndex(a => a.callback === callback) != -1;\r\n    }\r\n\r\n    /**\r\n     * Get a shortcut with it's callback if found\r\n     * @param {string} shortcut \r\n     * @param {function} callback \r\n     * @returns\r\n     */\r\n    find(shortcut, callback) {\r\n        let _this = this;\r\n        let index = this.#bindings.findIndex(a => a.content === shortcut && a.callback === callback);\r\n\r\n        return {\r\n            index,\r\n            get: () => index != -1 ? JSON.parse(JSON.stringify(_this.#bindings[index])) : null,\r\n            unbind: () => index != -1 ? _this.unbind(shortcut, callback) : null\r\n        }\r\n    }\r\n\r\n}\r\n\r\nlet qway = new QwayClass();\r\n\r\nexport default qway;\r\n"],"names":["noop","keyMap","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","space","enter","backspace","tab","capslock","escape","insert","delete","home","end","pageup","pagedown","contextmenu","arrowup","arrowdown","arrowleft","arrowright","shift","control","ctrl","command","alt","meta","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","numlock","numpad0","numpad1","numpad2","numpad3","numpad4","numpad5","numpad6","numpad7","numpad8","numpad9","numpaddecimal","numpaddivide","numpadmultiply","numpadsubtract","numpadadd","numpadenter","printscreen","scrolllock","pause","browserback","browserforward","browserrefresh","browserstop","browsersearch","browserfavorites","browserhome","volumemute","volumedown","volumeup","mediatracknext","mediatrackprevious","mediaplaypause","launchmail","launchapp1","launchapp2","eject","intlbackslash","intlro","intlyen","intlhash","conversion","nonconversion","again","copy","cut","paste","find","props","select","undo","redo","help","stop","sleep","wakeup","hiragana","katakana","accept","modechange","navigator","userAgentData","platform","toUpperCase","includes","translateKey","key","hasOwnProperty","translateCombo","test","toLowerCase","BindingEvent","CustomEvent","constructor","type","payload","Error","super","detail","bubbles","cancelable","composed","this","binding","qway","QBuildEvent","builder","progress","current","len","Binding","content","callback","options","Set","events","onprogress","onfinish","onEvent","name","ev","keyUp","keyDown","reset","ShortcutBinding","arr","Array","isArray","seqs","forEach","short","sequence","split","map","push","sequences","length","fill","code","prg","_this","add","pressed","from","isMatch","every","preventDefault","clear","ComboBinding","delay","timeout","clearTimeout","setTimeout","TimedKey","rawKey","dur","parseFloat","fragile","QBuilder","on","cb","start","receive","evName","size","trigger","approve","bind","getString","abort","joinment","final","fs","Object","values","kcode","join","bindings","keys","activated","bindEvents","window","addEventListener","bnd","declineFromUser","shortcut","reserved","unbind","findIndex","splice","replace","off","ctx","args","call","isKeyPressed","getFromUser","approveFromUser","replaceInCase","fn","attached","activate","disactivate","index","get","JSON","parse","stringify"],"mappings":"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"}